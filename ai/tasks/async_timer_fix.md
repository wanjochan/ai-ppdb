# 异步定时器修复任务

## 问题描述
在运行 `test_infrax_async` 测试时，定时器相关的测试用例失败。具体错误为：
```
assert(state.value == 2) failed
```

## 问题分析
1. 测试场景：
   - 测试创建了一个异步定时器任务
   - 任务应该执行两次状态值递增（state.value++）
   - 第一次递增在定时器启动前
   - 第二次递增在定时器触发后
   
2. 发现的问题：
   - 协程状态管理问题：协程在第一次执行后被错误标记为完成
   - 定时器事件问题：定时器的时间获取方式不正确

## 解决方案
1. 修复协程状态管理：
   - 移除自动将 ASYNC_READY 状态标记为 ASYNC_DONE 的逻辑
   - 当协程处于 ASYNC_READY 状态时，将其重新加入到就绪队列
   - 添加对 ASYNC_DONE 状态的明确处理

2. 修复定时器事件：
   - 使用全局 InfraxCore 实例来获取时间
   - 正确设置定时器的开始时间
   - 实现定时器事件的就绪检查逻辑

## 执行记录
1. 修复协程状态管理 [已完成]
2. 修复定时器事件实现 [已完成]
3. 等待测试验证

## 后续计划
1. 运行测试验证修复是否成功
2. 如果测试仍然失败，需要进一步分析问题
3. 考虑添加更多的日志来帮助调试
