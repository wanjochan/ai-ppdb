# 线程相关代码重构计划

## 问题
需要将 infra_sync 模块中与线程相关的代码移动到 infra_thread 模块中。

## 分析
1. infra_sync.h 中包含以下线程相关内容：
   - 线程基本操作（创建、加入、分离）
   - 线程池相关定义和操作
2. infra_thread.h 已经有一些线程池相关的定义，但被注释掉了
3. 需要合理处理依赖关系，避免循环依赖

## 迁移方案
1. 将以下内容从 infra_sync.h 移动到 infra_thread.h：
   - infra_thread_t 类型定义
   - infra_thread_func_t 类型定义
   - 线程基本操作函数声明
   - 线程池相关结构体和函数声明

2. 相应的实现代码也需要从 infra_sync.c 移动到 infra_thread.c

3. 需要调整的依赖关系：
   - infra_sync.h 需要包含 infra_thread.h 以使用线程类型
   - 确保没有循环依赖

## 执行步骤
1. [x] 分析源文件内容
2. [x] 识别线程相关代码
3. [x] 制定迁移方案
4. [x] 执行代码迁移：
   - [x] 更新 infra_thread.h
   - [x] 更新 infra_thread.c
   - [x] 更新 infra_sync.h
   - [x] 更新 infra_sync.c
5. [ ] 调整测试用例
6. [ ] 验证功能

## 已完成的更改
1. 创建了新的 infra_thread.h 文件，包含：
   - 线程基本类型和操作
   - 线程池相关定义
   - 线程池操作接口

2. 创建了新的 infra_thread.c 文件，包含：
   - 线程基本操作实现
   - 线程池内部结构定义
   - 线程池操作实现
   - 工作线程函数实现

3. 更新了 infra_sync.h：
   - 移除了线程相关定义
   - 添加了对 infra_thread.h 的引用
   - 保留了同步原语相关定义

4. 更新了 infra_sync.c：
   - 移除了线程相关实现
   - 保留了同步原语相关实现

## 注意事项
1. 保持谨慎，避免破坏现有功能
2. 确保头文件依赖关系正确
3. 保持代码风格一致性
4. 记录所有重要更改
5. 确保同步原语（mutex、条件变量等）仍然留在 infra_sync 模块中

## 下一步
1. 检查并调整相关测试用例
2. 验证所有功能是否正常工作
3. 检查是否有遗漏的线程相关代码 