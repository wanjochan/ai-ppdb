# InfraxAsync 增强计划

## 问题
目前的异步实现基于 setjmp/longjmp 和 pipe+poll，虽然实现了基本功能，但在使用体验和功能完整性上还有提升空间。

## 分析
当前实现的优点：
- 使用 setjmp/longjmp 实现了基本的协程功能
- 通过 pipe+poll 实现了异步通知机制
- 代码结构清晰，易于理解

需要改进的方面：
- 调用方式可以更优雅
- 缺少常用异步模式的封装
- 多任务并发支持不足
- 缺少高级特性（超时、取消等）

## 优化方案

### 1. 提升调用体验
- [ ] 实现 Promise/Future 模式
- [ ] 添加 async/await 风格宏
- [ ] 提供高阶函数（map/reduce等）

### 2. 预制异步模式
- [ ] IO异步模式（文件读写）
- [ ] 网络异步模式（socket操作）
- [ ] 批处理模式（大量数据处理）

### 3. 并发支持
- [ ] 实现 async_all 和 async_race
- [ ] 添加任务组管理
- [ ] 提供资源池管理

### 4. 高级特性
- [ ] 超时机制
- [ ] 取消机制
- [ ] 错误处理和恢复
- [ ] 事件通知
- [ ] 优先级调度

## 执行计划
1. 优先实现 async/await 风格宏，改善基本使用体验
2. 实现 IO 和网络异步模式，满足最常见需求
3. 添加并发支持
4. 逐步添加高级特性

## 注意事项
- 保持向后兼容
- 确保性能不会显著降低
- 保持代码简洁性
- 完善文档和示例
