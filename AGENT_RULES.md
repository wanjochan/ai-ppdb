# Agent Rules

⚠️ **重要提示：所有 AI 助理必须首先阅读并遵循以下内容**

## 🎯 核心原则

1. **保持专注**
   - 始终记住这是一个高性能并行数据库项目
   - 每个文件都有其特定用途，不要偏离其职责
   - 不要随意创建新文件或添加无关功能

2. **固定的文件结构**
   - 请参考 [项目架构文档](ppdb/docs/ARCHITECTURE.md) 了解详细的项目结构和职责划分
   - 不要随意更改已定义的文件结构
   - 新功能必须遵循现有的分层架构

3. **明确的职责划分**
   - 每个模块都有其明确定义的职责和边界
   - 模块之间通过良好定义的接口进行通信
   - 避免跨层级调用或循环依赖

4. **清晰的分层**
   - 遵循分层架构设计
   - 确保每一层只依赖其下层
   - 保持层与层之间的接口简洁清晰

5. **严格规范**
   - 不要未做检查就随便创建新文件
   - 遵循分层结构
   - 保持代码整洁

## 🤖 Agent 工作准则

智能体们（Cursor, Windsurf, Devin, Clinet等）必须遵循：

1. **语言使用规范**
   - 对话使用中文，保持简洁（concise）和精准（precise）
   - 项目文档中英皆可
   - 代码及注释必须使用英文

2. **开发规范**
   - 新建文件或函数前，先检查是否有类似可重用的内容
   - 新建文件需要先讨论确认
   - 修改文件时要细心，避免误删
   - 行动前做好计划，善用并行处理和批处理
   - 每次行动前重读本文档

3. **问题解决**
   - 遇到解决不了的问题，可使用curl工具（使用代理http://127.0.0.1:8888）寻找解决方案

## ⚠️ 常见错误防范

1. **保持专注** 
   - 不要突然创建不必要的新文件
   - 不要突然开始创建额外的模块
   - 不要偏离现有的文件结构

2. **避免过度拆分**
   - 新功能应该放在现有文件中
   - engine.h 可以容纳所有引擎核心功能
   - 避免不必要的文件拆分

3. **保持一致性**
   - 所有公共API都在 ppdb.h
   - 所有引擎功能都在 engine.h
   - 所有工具函数都在 base.h

## 🚀 开发流程

1. **会话启动规范**
   每次启动新会话时，用户只需要说：
   ```
   请先阅读 AGENT_RULES.md。

   我们现在要实现XXX功能。
   ```

2. **任务处理流程**
   - 先确定功能属于哪一层
   - 在对应文件中实现
   - 保持结构简单清晰

## 📂 项目结构

### ppdb/
- 这是由智能助理们协助编写的分布式数据库项目
- 项目使用 cosmopolitan 底层，.h/.c代码的引用部分不需要用libc头文件
- 必须注意本项目使用cosmopolitan跨平台底层
- 构建工具（cosmocc,cross9）应在项目仓根目录，找不到时需要确认
- 项目文档位于 ppdb/docs/

### cosmo/
- 【实验项目】使用 cosmopolitan 开发的小工具项目

### repos/
- 用于存放其他库或下载文件
- 本目录不是项目，不要提交和推送
