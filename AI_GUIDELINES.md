# AI 助理指南

## 🎯 核心原则

1. **保持专注**
   - 始终记住这是一个高性能并行数据库项目
   - 每个文件都有其特定用途，不要偏离其职责
   - 不要随意创建新文件或添加无关功能

2. **固定的文件结构**

ppdb 项目

   ```
ppdb/
├── include/
│   └── ppdb.h         # 唯一的公共头文件
├── test/              # 测试目录
├── src/
│   ├── internal/      # 内部实现头文件
│   │   ├── base.h     # 基础设施
│   │   ├── engine.h   # 引擎核心
│   │   ├── storage.h  # 存储系统
│   │   └── peer.h     # 节点管理
│   ├── base/          # 基础设施实现
│   ├── base.c
│   ├── engine/        # 引擎核心实现
│   ├── engine.c
│   ├── storage/       # 存储系统实现（libppdb）
│   ├── storage.c
│   ├── peer/         # 各种服务端/客户端实现
│   └── peer.c
└── ppdb.c # 主程序入口（启动 Server、CLI、网络接口、分布式网络与节点）
   ```

3. **明确的职责划分**
   - ppdb.h：公共API，这是用户唯一需要包含的头文件
   - base.h：基础工具函数（内存、日志、工具等）
   - engine.h：引擎层核心功能实现（事务、并发控制等）
   - storage.h：存储引擎实现（数据组织、持久化等）
   - peer.h：节点管理实现（集群、通信等）

4. **清晰的分层**
   - 公共API层（ppdb.h）：对外接口
   - 引擎层（engine.h/c）：
     - 事务管理
     - 并发控制
   - 存储层（storage.h/c）：存储引擎
   - 节点层（peer.h/c）：节点管理
   - 基础层（base.h/c）：基础设施

5. **严格规范**
   - 不要未做检查就随便创建新文件！
   - 遵循分层结构
   - 保持代码整洁

## ⚠️ 常见错误

1. **不要走神！** 
   - 不要突然想到"这个功能应该放在新文件里"
   - 不要突然开始创建额外的模块
   - 不要偏离现有的文件结构

2. **不要过度拆分！**
   - 新功能应该放在现有文件中
   - engine.h 可以容纳所有引擎核心功能
   - 文件拆分会增加复杂性

3. **保持一致性！**
   - 所有公共API都在 ppdb.h
   - 所有引擎功能都在 engine.h
   - 所有工具函数都在 base.h

## ⚠️ 注意事项

1. **不要走神！** 
   - 不要创建新文件
   - 不要偏离现有结构
   - 代码必须放在正确位置

2. **开发流程**
   - 先确定功能属于哪一层
   - 在对应文件中实现
   - 保持结构简单清晰

## 🚀 开发流程

1. 收到新任务时：
   - 先确定这是公共API还是内部实现
   - 公共API → ppdb.h
   - 内部实现 → 对应模块的头文件
   - 工具函数 → base.h

2. 写代码时：
   - 保持在正确的文件中
   - 遵循现有的代码风格
   - 不要创建新文件
   - 如果想创建新文件，停下来问问自己：真的需要吗？

3. 完成任务时：
   - 检查是否遵循了文件结构
   - 确保没有创建新文件
   - 验证代码位于正确的位置
