# AI 助理指南

## 🎯 核心原则

1. **保持专注**
   - 始终记住这是一个高性能并行数据库项目
   - 每个文件都有其特定用途，不要偏离其职责
   - 不要随意创建新文件或添加无关功能

2. **固定的文件结构**
   ```
   ppdb/
   ├── include/ppdb/
   │   ├── ppdb.h     【唯一的公共API】
   │   └── internal.h 【唯一的内部入口】
   └── internal/
       ├── base.h     【基础工具函数】
       └── core.h     【核心功能实现】
   ```
   - 头文件（接口定义）：
     - ppdb.h：公共API
     - internal.h：内部实现入口
     - base.h：基础工具
     - core.h：核心实现（包括storage和peer）
   - 源文件（具体实现）：
     - base.c：基础工具实现
     - core.c：核心功能实现（包括storage和peer）

3. **明确的职责划分**
   - ppdb.h：公共API，这是用户唯一需要包含的头文件
   - internal.h：内部实现的统一入口
   - base.h：基础工具函数（内存、日志、工具等）
   - core.h：核心功能实现（所有主要功能都在这里）

4. **清晰的分层**
   - 公共API层（ppdb.h）：对外接口
   - 核心层（core.h/c）：
     - 事务管理
     - 并发控制
     - storage模块：存储引擎
     - peer模块：节点管理
   - 基础层（base.h/c）：基础设施

5. **严格规范**
   - 不要创建新文件
   - 遵循分层结构
   - 保持代码整洁

## ⚠️ 常见错误

1. **不要走神！** 
   - 不要突然想到"这个功能应该放在新文件里"
   - 不要突然开始创建额外的模块
   - 不要偏离现有的文件结构

2. **不要过度拆分！**
   - 新功能应该放在现有文件中
   - core.h 可以容纳所有核心功能
   - 文件拆分会增加复杂性

3. **保持一致性！**
   - 所有公共API都在 ppdb.h
   - 所有内部实现都在 core.h
   - 所有工具函数都在 base.h

## ⚠️ 注意事项

1. **不要走神！** 
   - 不要创建新文件
   - 不要偏离现有结构
   - 代码必须放在正确位置

2. **开发流程**
   - 先确定功能属于哪一层
   - 在对应文件中实现
   - 保持结构简单清晰

## 🚀 开发流程

1. 收到新任务时：
   - 先确定这是公共API还是内部实现
   - 公共API → ppdb.h
   - 内部实现 → core.h
   - 工具函数 → base.h

2. 写代码时：
   - 保持在正确的文件中
   - 遵循现有的代码风格
   - 不要创建新文件
   - 如果想创建新文件，停下来问问自己：真的需要吗？

3. 完成任务时：
   - 检查是否遵循了文件结构
   - 确保没有创建新文件
   - 验证代码位于正确的位置

## 📝 检查清单

每次写代码前问自己：
1. 这是哪一层的功能？
2. 应该放在哪个文件？
3. 是否遵循了项目结构？

每次修改代码前，问问自己：
1. 这段代码应该放在哪个文件？
2. 我是否在正确的文件中？
3. 我是否在保持项目的简洁性？
4. 我是否在遵循项目结构？

记住：简单清晰的结构才是最好的！
