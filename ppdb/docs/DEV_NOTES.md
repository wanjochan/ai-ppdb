# 开发笔记

## 功能完善计划

### Base 层
1. 内存池管理
   - [ ] 添加统计功能
   - [ ] 优化内存分配策略

2. 异步IO系统
   - [ ] 完善基础框架
   - [ ] 添加性能监控
   - [ ] 实现回调机制

3. 事件循环
   - [ ] 设计核心接口
   - [ ] 实现定时器功能
   - [ ] 添加性能统计

### Database 层
1. 核心功能
   - [ ] 完善KV操作接口
   - [ ] 实现基本事务
   - [ ] 设计MVCC框架

2. 存储引擎
   - [ ] 实现内存表
   - [ ] 设计WAL接口
   - [ ] 规划持久化方案

### Peer 层
1. 协议支持
   - [ ] 完成Memcached基本命令
   - [ ] 设计通用协议框架
   - [ ] 规划Redis适配

## 优化建议

1. 接口合并
   - 统一锁接口（mutex/spinlock）
   - 统一IO接口（同步/异步）
   - 统一协议处理框架

2. 跨层重构
   - 将序列化移至Database层
   - 将通用IO操作移至Base层

## 长期规划

1. 分布式功能
   - [ ] 节点发现
   - [ ] 数据分片
   - [ ] 一致性协议

2. 性能优化
   - [ ] 引入性能基准测试
   - [ ] 优化关键路径
   - [ ] 减少锁竞争 


## TODO 

- infra 是不是有些【内存管理】的封装没做？
- infra 层要检查一下，除了 sync 不应有对 pthread的调用？应该是用 sync中的封装
- 异步那里针对 windows做一个 IOCP优化（在ppdb_prev还有备份可以参考）
- 从 ppdb_prev的 sync_perf 中参考下同步有没有优化的地方
 